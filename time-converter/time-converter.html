<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Time to Decimal Calculator</title>

  <style>
    .tabContent {
      display: none;
    }
  </style>
</head>

<body>

  <div class="tab">
    <button class="tabLinks active" onclick="openTab(event, 'time-to-decimal-container')">Time to Decimal</button>
    <button class="tabLinks" onclick="openTab(event, 'decimal-to-time-container')">Decimal to Time</button>
    <button class="tabLinks" onclick="openTab(event, 'minutes-to-hours-container')">Minutes to Hours Converter</button>
    <!-- <button class="tabLinks" onclick="openTab(event, 'time-conversion')">Time Conversion Calculator</button> -->
  </div>

  <div id="time-to-decimal-container" class="tabContent" style="display: block;">
    <form id="time-to-decimal-form">
      <h2>Time to Decimal Calculator</h2>
      <div>
        <label for="hours">
          <abbr title="Hours">HH</abbr>
        </label>
        <input type="number" name="hours" id="hours" min="0" max="999">

        <label for="minutes">
          <abbr title="Minutes">MM</abbr>
        </label>
        <input type="number" name="minutes" id="minutes" min="0" max="59">

        <label for="seconds">
          <abbr title="Seconds">SS</abbr>
        </label>
        <input type="number" name="seconds" id="seconds" min="0" max="59">
      </div>

      <div>
        <label for="decimals">Max decimal places</label>
        <input type="number" name="decimals" id="decimals" min="0" max="9" value="4">
      </div>
      <input type="submit" value="Calculate" class="btn">
    </form>
  </div>


  <div id="decimal-to-time-container" class="tabContent">
    <form id="decimal-to-time-form">

      <h2>Decimal to Time Calculator</h2>

      <label for="decimalTime">Decimal Time </label>
      <input type="number" name="decimalTime" id="decimalTime" step="any" min="0" max="99999999">

      <label for="timeUnit">Time Unit</label>
      <select name="timeUnit" id="timeUnit">
        <option value="days">Days</option>
        <option value="hours">Hours</option>
        <option value="minutes">Minutes</option>
        <option value="seconds">Seconds</option>
      </select>
      <!-- <div>
        <input type="checkbox" name="inclDays" id="inclDays">
        <label for="inclDays">Include days in answer</label>
      </div> -->
      <input type="submit" value="Calculate" class="btn">

    </form>
  </div>


  <div id="minutes-to-hours-container" class="tabContent">
    <form id="minutes-to-hours">
      <h2>Minutes to Hours Converter</h2>
      <div>
        <label for="minutes">Enter minutes</label>
        <input type="number" name="minutes" id="minutes" min="0" max="9999999">
      </div>
      <input type="submit" value="Calculate" class="btn">
    </form>
  </div>




  <div id="answer">
    <br>
    Hours: 0
    <br>
    Minutes: 0
    <br>
    Seconds: 0
  </div>


  <script>
    const timeToDecimalForm = document.getElementById("time-to-decimal-form");
    const decimalToTimeForm = document.getElementById("decimal-to-time-form");
    const minutesToHoursForm = document.getElementById("minutes-to-hours");
    const answerDiv = document.getElementById("answer");
    let hours, minutes, seconds, decimals, hoursAns, minutesAns, secondsAns;

    timeToDecimalForm.onsubmit = function (e) {
      e.preventDefault();
      timeToDecimal(this)
    }

    minutesToHoursForm.onsubmit = function (e) {
      e.preventDefault();
      minutesToHours(this)
    }

    decimalToTimeForm.onsubmit = function (e) {
      e.preventDefault();

      let val = this.decimalTime.value

      switch (this.timeUnit.value) {
        case 'days':
          val = val * 60 * 60 * 24
          decimalToTime(val)
          break;
        case 'hours':
          val = val * 60 * 60
          decimalToTime(val)
          break;
        case 'minutes':
          val = val * 60
          decimalToTime(val)
          break;
        case 'seconds':
          decimalToTime(val)
          break;
      }
    }

    function timeToDecimal(form) {
      hours = +form.hours.value || 0;
      minutes = +form.minutes.value || 0;
      seconds = +form.seconds.value || 0;
      decimals = +form.decimals.value || 0;

      hoursAns = calcHours(hours, minutes, seconds)
      minutesAns = calcMinutes(hours, minutes, seconds)
      secondsAns = calcSeconds(hours, minutes, seconds)

      answerDiv.innerHTML = `
            <br>
            Hours: ${round(hoursAns, decimals)} 
            <br>
            Minutes: ${round(minutesAns, decimals)} 
            <br>
            Seconds: ${round(secondsAns, decimals)}
            `
    }

    function calcHours(hours, minutes, seconds) {
      return hours + (minutes / 60) + (seconds / 3600);
    }

    function calcMinutes(hours, minutes, seconds) {
      return (hours * 60) + minutes + (seconds / 60);
    }

    function calcSeconds(hours, minutes, seconds) {
      return (hours * 3600) + (minutes * 60) + seconds;
    }

    function round(value, decimals) {
      //using scientific notation when rounding is more accurate than alternatives
      return Number(Math.round(value + `e${decimals}`) + `e-${decimals}`);
    }


    // ___________________________________________________________

    // let inclDays = document.getElementById("inclDays");

    function decimalToTime(seconds) {
      let answer = []

      hours = seconds / 3600;
      minutes = hours % 1 * 60;
      seconds = minutes % 1 * 60;

      // if (Math.trunc(hours) > 24 && inclDays.checked) {
      //   days = Math.trunc(hours) / 24
      //   answer.push(
      //     Math.trunc(days)
      //   );
      //   hours = hours - Math.trunc(days) * 24
      // }

      answer.push(
        Math.trunc(hours)
          .toString()
          .padStart(2, '0')
      );

      answer.push(
        Math.trunc(minutes)
          .toString()
          .padStart(2, '0')
      );

      answer.push(
        Math.trunc(seconds)
          .toString()
          .padStart(2, '0')
      );

      answerDiv.innerHTML = `     
            <br>
            Hours: ${Math.trunc(hours)} 
            <br>
            Minutes: ${Math.trunc(minutes)} 
            <br>
            Seconds: ${Math.trunc(seconds)}
            <br>
            ${answer.join(':')}
            `
    }


    // ________________________________________________________

    function minutesToHours(e) {
      minutes = e.minutes.value;
      let hoursDecimal = round(minutes / 60, 6)
      let minutesTime = Math.round(hoursDecimal % 1 * 60)
      let hoursTime = Math.trunc(hoursDecimal)

      answerDiv.innerHTML = `     
            <br>
            ${hoursTime} hours and ${minutesTime} minutes
            <br>
            ${hoursTime}:${minutesTime.toString().padStart(2, '0')}
            <br>
            Decimal hours: ${hoursDecimal}
            `
    }


    // ________________________________________________________

    function openTab(evt, cityName) {
      let i, tabContent, tabLinks;
      tabContent = document.getElementsByClassName("tabContent");
      for (i = 0; i < tabContent.length; i++) {
        tabContent[i].style.display = "none";
      }
      tabLinks = document.getElementsByClassName("tabLinks");
      for (i = 0; i < tabLinks.length; i++) {
        tabLinks[i].className = tabLinks[i].className.replace(" active", "");
      }
      document.getElementById(cityName).style.display = "block";
      evt.currentTarget.className += " active";
    }

  </script>
</body>

</html>